<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í”ŒëœíŠ¸ ì •ë³´ ì•„ì¹´ì´ë¸Œ í˜„í™©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f9; padding: 50px 20px; font-family: sans-serif; }
        .dashboard { max-width: 800px; margin: auto; background: white; padding: 35px; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
        .status-display { margin-top: 30px; padding: 25px; border-radius: 10px; border-left: 10px solid #cbd5e0; transition: 0.3s; }
        .status-Shutdown { border-left-color: #e53e3e; background-color: #fff5f5; }
        .status-Run-Cut { border-left-color: #ecc94b; background-color: #fffff0; }
        .data-label { font-size: 0.8rem; text-transform: uppercase; color: #718096; letter-spacing: 0.05em; margin-bottom: 4px; }
        .data-value { font-size: 1.15rem; font-weight: 700; color: #2d3748; margin-bottom: 15px; }
        .comment-box { margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 6px; font-style: italic; color: #4a5568; }
    </style>
</head>
<body>

<div class="dashboard">
    <h2 class="text-center mb-5 fw-bold text-dark">ğŸ” ì‹¤ì‹œê°„ í”ŒëœíŠ¸ ì •ë³´ ê²€ìƒ‰</h2>
    
    <div class="row g-3">
        <div class="col-md-6">
            <label class="form-label fw-semibold">í’ˆëª© (Product)</label>
            <select id="pSelect" class="form-select" onchange="loadCompanies()"><option value="">í’ˆëª© ì„ íƒ</option></select>
        </div>
        <div class="col-md-6">
            <label class="form-label fw-semibold">ì—…ì²´ (Company)</label>
            <select id="cSelect" class="form-select" onchange="renderInfo()" disabled><option value="">ì—…ì²´ ì„ íƒ</option></select>
        </div>
    </div>

    <div id="infoArea"></div>
</div>

<script>
    const URL = "https://script.google.com/macros/s/AKfycbzKpzR8wEzTUwidmthvlXDnIBZxV2JScwU9NvYvYrncwsX62uC3K70sec3K6uvZPx2bpQ/exec";
    let db = [];

    async function start() {
        const r = await fetch(URL);
        const d = await r.json();
        db = d.slice(1); // í—¤ë” ì œì™¸
        const prods = [...new Set(db.map(x => x[3]))].filter(x => x && x !== "-");
        prods.forEach(p => document.getElementById('pSelect').innerHTML += `<option value="${p}">${p}</option>`);
    }

    function loadCompanies() {
        const p = document.getElementById('pSelect').value;
        const cS = document.getElementById('cSelect');
        cS.innerHTML = '<option value="">ì—…ì²´ ì„ íƒ</option>';
        if(!p) { cS.disabled = true; return; }
        const comps = [...new Set(db.filter(x => x[3] === p).map(x => x[1]))];
        comps.forEach(c => cS.innerHTML += `<option value="${c}">${c}</option>`);
        cS.disabled = false;
        document.getElementById('infoArea').innerHTML = "";
    }

    function renderInfo() {
        const p = document.getElementById('pSelect').value;
        const c = document.getElementById('cSelect').value;
        const area = document.getElementById('infoArea');
        const item = db.reverse().find(x => x[3] === p && x[1] === c); // ìµœì‹  ë°ì´í„°

        if(item) {
            const sClass = item[5].replace(" ", "-"); 
            area.innerHTML = `
                <div class="status-display status-${sClass}">
                    <div class="row">
                        <div class="col-6"><div class="data-label">Status</div><div class="data-value">${item[5]}</div></div>
                        <div class="col-6"><div class="data-label">Capacity (Capa)</div><div class="data-value">${item[4]}</div></div>
                        <div class="col-12"><div class="data-label">Event Period</div><div class="data-value">${item[6]}</div></div>
                        <div class="col-12"><div class="data-label">Reason</div><div class="data-value">${item[7]}</div></div>
                        <div class="col-12">
                            <div class="data-label">Comments</div>
                            <div class="comment-box">${item[8]}</div>
                        </div>
                        <div class="col-12 mt-3 text-end">
                            <small class="text-muted">Last Updated: ${new Date(item[0]).toLocaleString()}</small>
                        </div>
                    </div>
                </div>
            `;
        }
    }
    start();
</script>
</body>
</html>
